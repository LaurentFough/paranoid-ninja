# Avoid kernel memory address exposures via dmesg.
kernel.dmesg_restrict=1

# Hide kernel addresses in /proc and other interfaces, even to privileged users.
kernel.kptr_restrict=2

# Enable the strictest ptrace scope restriction provided by the Yama LSM.
kernel.yama.ptrace_scope=3

fs.protected_symlinks=1
fs.protected_hardlinks=1

# Do not create core dumps of setuid executables. Note that we already disable all core dumps by setting CONFIG_COREDUMP=n.
fs.suid_dumpable=0

# Disable User Namespaces, as it opens up a large attack surface to unprivileged users.
user.max_user_namespaces=0
